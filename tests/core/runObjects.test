----------------------------------------------------------------------------------------------------

+ Thing {
    a = 42
    b = 99
}

+ main() {
    x = Thing()
    -- x.b
    x.b = 100
    -- x.b
}

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

99
100

----------------------------------------------------------------------------------------------------

+ Thing {
    a = b + 1
    b = 42
}

+ main() {
    x = Thing()
    -- x.a
}

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

43

----------------------------------------------------------------------------------------------------

+ Thing {
    a = 42
    b = a + 1
}

+ main() {
    x = Thing()
    -- x.b
}

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

43

----------------------------------------------------------------------------------------------------
# Circular property reference

+ Thing {
    a = b
    b = a
}

+ main() {
    x = Thing()
    -- x.b
}

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

Exception: Circular reference to "a"
<no file>, line 4

----------------------------------------------------------------------------------------------------

+ Thing {
}

+ main() {
    x = Thing()
    -- x.c
}

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
%mode: ir

Exception: Property "c" not found
<no file>, line 7

----------------------------------------------------------------------------------------------------

+ Thing {
}

+ main() {
    x = Thing()
    x.c = 1
}

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

Exception: Property "c" not found
<no file>, line 7

----------------------------------------------------------------------------------------------------

+ main() {
    x = 1
    -- x.c
}

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

Exception: Property "c" not found
<no file>, line 4

----------------------------------------------------------------------------------------------------

+ main() {
    x = 1
    x.c = 1
}

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

Exception: Property "c" not found
<no file>, line 4

----------------------------------------------------------------------------------------------------

+ Thing\T1 {
    a:T1 = 1.5
}

+ main() {
    t1 = Thing\Double()
    -- t1.a
    t2 = Thing\Int32()
    -- t2.a
}

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

1.500000
1

----------------------------------------------------------------------------------------------------
# Multiple type parameters

+ Foo\T1\T2 {
    a:T1 = 1.5
    b:T2 = 1.5
}

+ main() {
    t = Foo\Double\Int32()
    -- t.a
    -- t.b
}

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

1.500000
1

----------------------------------------------------------------------------------------------------

+ Thing\T1 {
    a:T1 = 0
}

+ foo\T(j:Thing\T) {
    x:T = 1.5
    -- x
}

+ main() {
    t1 = Thing\Double()
    foo(t1)
    t2 = Thing\Int32()
    foo(t2)
}

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

1.500000
1

----------------------------------------------------------------------------------------------------
# Extract type of nested type parameters

+ Foo\T1 {
    a = 0
}

+ List\T1 {
    b:T1 = 0
}

+ Map\T1 {
    b:T1 = 0
}

+ foo\T(j:Foo\(List\T)) {
    x:T = 1.5
    -- x
}

+ main() {
    t = Foo\(List\Double)()
    foo(t)
}

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

1.500000

----------------------------------------------------------------------------------------------------
