----------------------------------------------------------------------------------------------------

-- {}

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

<Map {}>

----------------------------------------------------------------------------------------------------

map = {}
map["a"] = 1
-- map.length
map["b"] = 1
-- map.length

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

1
2

----------------------------------------------------------------------------------------------------

map = {}
map["a"] = 3
-- map["a"]

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

3

----------------------------------------------------------------------------------------------------

map = {}
map["a"] = 3
map["a"] = 4
-- map["a"]

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

4

----------------------------------------------------------------------------------------------------

map = {}
map["a"] = 1
map[42] = 2
map[Object()] = 3
keys = map.keys
-- keys.length
-- keys[0]
-- keys[1]
-- keys[2]

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

3
<Object Object>
a
42

----------------------------------------------------------------------------------------------------

map = {}
map["a"] = 1
map["b"] = 2
map[42] = 3
values = map.values
-- values.length
-- values[0]
-- values[1]
-- values[2]

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

3
2
1
3

----------------------------------------------------------------------------------------------------

map = {}
map["a"] = 1
map["b"] = 2
-= map["a"]
-- map

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

<Map {b}>

----------------------------------------------------------------------------------------------------

map = {}
map["a"] = 1
-- "a" is in map
-- "c" is in map

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

true
false

----------------------------------------------------------------------------------------------------

map = {}
map["a"] = 42
map["b"] = 1
map["c"] = 42
for key in map.find(42)
    -- key

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

a
c

----------------------------------------------------------------------------------------------------

map = {}
map["a"] = 1
map["b"] = 2
map["c"] = 3
for pair in map
    -- pair

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

[b, 2]
[a, 1]
[c, 3]

----------------------------------------------------------------------------------------------------

map = {}
map["a"] = 1
map2 = {}
map2["b"] = 2
map3 = map + map2
-- map3["a"]
-- map3["b"]

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

1
2

----------------------------------------------------------------------------------------------------

map = {}
map["a"] = 1
map["b"] = 1
map2 = {}
map2["b"] = 2
map3 = map - map2
-- map3["a"]
-- map3["b"]

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

1
undefined

----------------------------------------------------------------------------------------------------

key = "a"
map = {key = 3}
-- map["a"]

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

3

----------------------------------------------------------------------------------------------------

key = "a"
key2 = "b"
map = {key = 3, key2 = 4}
-- map["a"]
-- map["b"]

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

3
4

----------------------------------------------------------------------------------------------------

map = {"a" = 3, "b" = 4}
-- map["a"]

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

3

----------------------------------------------------------------------------------------------------
# Add enough items to make the map grow past its initial allocation of 8 buckets

map = {}
map["a"] = 1
map["b"] = 2
map["c"] = 3
map["d"] = 4
map["e"] = 5
map["f"] = 6
map["g"] = 7
map["h"] = 8
map["i"] = 9
map["j"] = 10
-- map["a"]
-- map["b"]
-- map["c"]
-- map["d"]
-- map["e"]
-- map["f"]
-- map["g"]
-- map["h"]
-- map["i"]
-- map["j"]

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

1
2
3
4
5
6
7
8
9
10

----------------------------------------------------------------------------------------------------

map = {undefined = 1}

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

Exception: Illegal key
<no file>, line 1, in <source>

----------------------------------------------------------------------------------------------------

map = {null = 1}
-- map[null]

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

1

----------------------------------------------------------------------------------------------------

map = {}
-- not map

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

true

----------------------------------------------------------------------------------------------------

map = {"a" = 1}
-- not map

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

false

----------------------------------------------------------------------------------------------------
# Undefined key

map = {}
-- map["a"]

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

undefined

----------------------------------------------------------------------------------------------------
# Default value for undefined key

map = {}
-- map["a"||1]

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

1

----------------------------------------------------------------------------------------------------
# Ensure correctness after reallocating buckets.
# This tests assumes 8 is the number of buckets in the initial allocation, so if that changes, this
# test needs to be updated to ensure it still triggers reallocation.

map = {
    "a" = 1,
    "c" = 2,
    "g" = 3,
    "t" = 4,
    "B" = 5,
    "D" = 6,
    "H" = 7,
    "K" = 8,
    "M" = 9,
    "N" = 1,
    "R" = 2,
    "S" = 3,
    "V" = 4,
    "W" = 5,
    "Y" = 6
}

-- map["t"]
map["c"] = 10
-- map["t"]

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

4
4

----------------------------------------------------------------------------------------------------
