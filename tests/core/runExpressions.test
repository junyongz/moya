----------------------------------------------------------------------------------------------------
# where in call expression

+ foo(a) => a * 2

do {
    -- foo(a) where {
        a = 5
    }
}

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

10

----------------------------------------------------------------------------------------------------
# where in call expression

+ foo(a) => a * 2
    
do {
    x = foo(a) where {
        a = 5
    }
    -- x
}

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

10

----------------------------------------------------------------------------------------------------
# where in call expression

+ foo(a) => a * 2

do {
    x = foo(a) where a = 5
    -- x
}

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

10

----------------------------------------------------------------------------------------------------
# where in call block

+ foo(a) => a * 2

do {
    -- foo {
        a
    } where {
        a = 5
    }
}

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

10

----------------------------------------------------------------------------------------------------
# where in property

+ Thing {
    + a = b where b = 10
}

do {
    thing = Thing()
    -- thing.a
}

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

10

----------------------------------------------------------------------------------------------------
# where in function

+ foo(a) {
    a * b
} where {
    b = 5
}

do {
    -- foo(5)
}

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

25

----------------------------------------------------------------------------------------------------
# where variable referring to argument

+ foo(a) {
    a * b
} where {
    b = a
}

do {
    -- foo(5)
}

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

25

----------------------------------------------------------------------------------------------------
# where variables referring to each other

+ foo() {
    b
} where {
    c = 10
    b = c
}

do {
    -- foo()
}

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

10

----------------------------------------------------------------------------------------------------
# where variables referring to each other out of order

+ foo() {
    b
} where {
    b = c
    c = 10
}

do {
    -- foo()
}

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

10

----------------------------------------------------------------------------------------------------
# where variable not used

- get(n) do {
    -- "get %n"
    = n
}

+ foo() {
    a
} where {
    a = get(1)
    b = get(2)
}

do {
    -- foo()
}

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

get 1
1

----------------------------------------------------------------------------------------------------

do {
    x = {
        -- "no"
    }
}

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

Exception: Illegal expression
<no file>, line 3
            -- "no"
            ^^^^^^^

----------------------------------------------------------------------------------------------------

do {
    x = {
        while {
        }
    }
}

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

Exception: Illegal expression
<no file>, line 3
            while {
            ^^^^^^^

----------------------------------------------------------------------------------------------------

do {
    x = {
        throw 42
    }
}

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

Exception: Illegal expression
<no file>, line 3
            throw 42
            ^^^^^^^^

----------------------------------------------------------------------------------------------------

do {
    x = {
        a = 1
    }
}

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

Exception: Illegal expression
<no file>, line 3
            a = 1
            ^^^^^

----------------------------------------------------------------------------------------------------

+ Thing {
    + count = 0
    
    + This(c) do {
        count = c
    }
    
    + with(n) => Thing(count - n)
}

+ expr() {
    Thing(10)
    2
    5
}

do {
    -- expr().count
}

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

3

----------------------------------------------------------------------------------------------------
